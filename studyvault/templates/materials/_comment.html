<li id="comment-{{ c.id }}" class="p-3 text-sm">
  <!-- header: name • time • (Delete if owner/staff) -->
  <div class="flex items-center gap-2 text-gray-700">
    <span class="font-medium">{{ c.user.username }}</span>
    <span class="text-gray-400">• {{ c.created_at|timesince }} ago</span>

    {% if user.is_authenticated and (user.id == c.user_id or user.is_staff) %}
      <button
        type="button"
        class="ml-auto text-red-600 hover:underline comment-delete"
        data-id="{{ c.id }}">
        Delete
      </button>
    {% endif %}
  </div>

  <!-- body -->
  <p class="mt-1 whitespace-pre-line">{{ c.body }}</p>

  <!-- reply toggle -->
  <div class="mt-2">
    <a href="#" class="text-xs underline text-gray-600 reply-toggle" data-parent="{{ c.id }}">Reply</a>
  </div>

  <!-- nested replies (if any) -->
  {% if c.children.all %}
    <ul class="mt-3 pl-4 border-l">
      {% for child in c.children.all %}
        {% include "materials/_comment.html" with c=child %}
      {% endfor %}
    </ul>
  {% endif %}

  <!-- inline reply form (hidden by default) -->
  <form class="reply-form mt-2 hidden" data-id="{{ c.material_id }}" data-parent="{{ c.id }}">
    <textarea name="body" rows="2"
              class="w-full border rounded px-3 py-2 text-sm"
              placeholder="Write a reply…"></textarea>
    <div class="mt-2 flex items-center gap-2">
      <button type="submit"
              class="px-3 py-1.5 text-sm border rounded hover:bg-black hover:text-white">
        Reply
      </button>
      <button type="button" class="reply-cancel text-xs underline">Cancel</button>
    </div>
  </form>
</li>
